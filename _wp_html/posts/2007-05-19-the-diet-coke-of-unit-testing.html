&lt;![CDATA[<p>I have been wanting to make use of Unit Testing in my personal projects and my projects at work. So far I've read a lot about unit testing concepts and implementations and even written a few tests to get a feel for it. The majority of the material that exists about unit testing in .NET refers to the <a href="http://sourceforge.net/projects/nunit">NUnit</a> testing framework. The is presumably because it was one of the first .NET unit testing frameworks and based on the well established JUnit. However, now that Visual Studio 2005 includes it's own unit testing framework, why wouldn't you want to use that?</p>
<p><a href="http://www.jpboodhoo.com/blog/">Jean-Paul Boodhoo</a>&nbsp;<a href="http://www.jpboodhoo.com/blog/AutomatingYourBuildsWithNAntPart1.aspx">once blogged</a><sup>1</sup> that when a new developer joins your team they should be able to Get Latest from source control, build, and be ready to work. I agree and using tools included in Visual Studio means one less dependency for a new developer to install on their workstation. However, there is the&nbsp;possibility that Visual Studio's Unit Testing, as a version 1.0 product,&nbsp;might be lacking important functionality to be found in established testing tools. A quick Google for "<a href="http://www.google.com/search?q=visual+studio+unit+testing+vs+nunit">visual studio unit testing vs nunit</a>" leads to a few notable issues.</p>
<p><a href="http://blogs.msdn.com/jason_anderson/archive/2004/06/04/148252.aspx">Jason Anderson explains</a> that only Visual Studio Team Suite includes the Unit Testing tools and that Visual Studio Professional misses out. We all use Team Suite at work so this isn't a problem but I can understand that unit testing should be available developers in all&nbsp;team sizes. Thankfully, Naysawn Naderi says that we can expect <a href="http://blogs.msdn.com/nnaderi/archive/2007/03/27/unit-testing-trickling-into-pro.aspx">Unit Testing in Visual Studio Pro</a> when Orcas is released.</p>
<p>Roy Osherove also has <a title="Bugs and Missing Features with Team System Unit Testing: Part I" href="http://weblogs.asp.net/rosherove/archive/2006/01/25/436414.aspx">two</a> <a title="MbUnit vs. NUnit Vs. Team System Unit Testing - Choosing a unit test framework" href="http://weblogs.asp.net/rosherove/archive/2006/09/24/MbUnit-vs.-NUnit-Vs.-Team-System-Unit-Testing-_2D00_-Choosing-a-unit-test-framework.aspx">posts</a> about choosing between Visual Studio Unit Testing and the alternatives. Roy's comments&nbsp;makes VS Unit Testing seem completely useless and claims some parts are broken and even says "how this one went by into the release is a mystery to me". However, I recently had the pleasure of working with VS Unit Testing briefly when contributing to the <a href="http://www.codeplex.com/BlogML">BlogML</a> project and some of Roy's claims just felt wrong. Surely it can't be that bad. Considering we will want to decide on a testing framework for projects at work soon, I decided to verify these problems.</p>
<p>Roy's first complaint is that there is a bug with the ExpectedException Attribute checking the type of the Exception only and not checking the Message. This is in fact a misinterpretation of the VS Unit Testing ExpectedException Attribute and assuming it was designed the same as NUnit's counterpart. NUnit takes an Exception type and message and verifies that the right Exception is thrown and that is has the matching message. VS treats the message parameter that same as an Assert statement and uses it as the display message to the user when the test fails, admittedly the MSDN documentation is very poorly worded. However, achieving the same behaviour as NUnit is often desired and there is a quick solution:</p>
<p><span style="font-size:11px;color:black;font-family:Courier New;background-color:transparent;">[TestMethod()]<br />[ExpectedException(<span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">typeof</span>(InvalidOperationException))]<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">public</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">void</span> ExceptionWithMessage()<br />{<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">&nbsp;&nbsp;&nbsp; try</span><br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MethodToTest();<br />&nbsp;&nbsp;&nbsp; }<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">&nbsp;&nbsp;&nbsp;&nbsp;catch</span> (InvalidOperationException ex)<br />&nbsp;&nbsp;&nbsp; {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Assert.AreEqual(<span style="font-size:11px;color:#666666;font-family:Courier New;background-color:#e4e4e4;">"Expected message."</span>, ex.Message);<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw</span>;<br />&nbsp;&nbsp;&nbsp; }<br />}</span></p>
<p>Roy is also disappointed that ExpectedException doesn't work with the base Exception type. Sure it's something the unit testing framework doesn't support but you shouldn't be throwing Exception objects and <a href="http://blogs.msdn.com/fxcop/archive/2006/06/14/631923.aspx">you shouldn't be catching them</a> either. You can also use the Test Results window to group by Result (ie Passed/Failed), Class Name, and Full Class Name (ie Namespace too), this makes locating the tests your interested in much easier and also negates Roy's corresponding observations with regard to Test Driven Development.</p>
<p>VS Unit Testing isn't perfect though and that's to be expected for a first release. As Roy points out, you can't easily get to the failing production code from a failed test result, it doesn't have quite as many included Asserts as NUnit does and you do need to have Visual Studio installed to use the MSTest command line test runner. For the time being, our requirements don't push VS beyond it's capabilities, Orcas should improve on the weaker points when it's released later this year (<a href="http://weblogs.asp.net/fmarguerie/archive/2006/05/17/first-orcas-release-date-estimate.aspx">?</a>) and it is really easy to <a href="http://www.google.com/search?q=convert+nunit">convert between NUnit and VS Unit Testing</a> if we need to.</p>
<p>So, if you're looking to choose a unit testing framework, don't be put off by some of the articles flying around about VS. Give NUnit and VS Unit Testing a go and maybe <a href="http://www.mbunit.com/">MbUnit</a> and some of the <a href="http://en.wikipedia.org/wiki/List_of_unit_testing_frameworks#.NET_programming_languages">others</a> too. Ultimately you'll find something that you and the rest of your team are comfortable with and fits your process. I can't say that any of them are perfect, nor are any flawed beyond useful. And, if you've managed to read this entire post, thanks for putting up with my ramblings ;).</p>
<p>
<hr />
<font size="1">1. Update: Added link to Jean-Paul Boodhoo's article.</font></p>
<p><a href="http://www.dotnetkicks.com/kick/?url=http://www.codeassassin.com/blog/PermaLink,guid,a05d52ba-ef83-4c33-a735-56a7fc55eca8.aspx"><img alt="kick it on DotNetKicks.com" src="http://www.dotnetkicks.com/Services/Images/KickItImageGenerator.ashx?url=http://www.codeassassin.com/blog/PermaLink,guid,a05d52ba-ef83-4c33-a735-56a7fc55eca8.aspx" border="0"></a></p>]]&gt;