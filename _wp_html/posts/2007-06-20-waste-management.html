&lt;![CDATA[<p>The script in <a href="http://www.codeassassin.com/blog/PermaLink,guid,d6ff9a43-6439-4acf-af45-12ee3089cf7d.aspx" target="_blank">my last post</a> for removing old files from the temporary folder is only necessary because so many applications don't clean up after themselves. Hopefully, if the applications you are&nbsp;developing are doing the right thing they will be using in memory streams where ever possible.&nbsp;Only&nbsp;write to disk when absolutely necessary,&nbsp;creating random temporary files in the environment temp folder, not program folders with restricted access to non-admin users:</p>
<p><span style="font-size:11px;color:black;font-family:Courier New;background-color:transparent;"><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">string</span> myTempFile <span style="font-size:11px;color:red;font-family:Courier New;background-color:transparent;">=</span> System.IO.Path.GetTempFileName();<br /><br /></span></p>
<p>However, remembering to track and delete these files when you are finished requires more effort and is often ignored, creating the ever growing temp folder problem. There is a lesser known class in the framework that can help you though:</p>
<p><span style="font-size:11px;color:black;font-family:Courier New;background-color:transparent;">var myTempColl <span style="font-size:11px;color:red;font-family:Courier New;background-color:transparent;">=</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">new</span> System.CodeDom.Compiler.TempFileCollection();<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">string</span> myTempImageFile <span style="font-size:11px;color:red;font-family:Courier New;background-color:transparent;">=</span> myTempColl.AddExtension(<span style="font-size:11px;color:#666666;font-family:Courier New;background-color:#e4e4e4;">"png"</span>);<br /><br /></span></p>
<p>Excuse the C# 3.0 syntax in the last snippet, I hate the redundancy of repeating long type names, especially on the same line. When you have finished using all the temp files you created with the TempFileCollection, you can dispose it explicitly, automatically deleting the files, or if you're really lazy, let the GC take care of it.</p>
<p><span style="font-size:11px;color:black;font-family:Courier New;background-color:transparent;">myTempColl.Dispose();</span></p>]]&gt;