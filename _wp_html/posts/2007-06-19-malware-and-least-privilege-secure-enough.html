&lt;![CDATA[<p>Jeff Atwood had some <a href="http://www.codinghorror.com/blog/archives/000888.html" target="_blank">trouble with malware</a> last week. His digging led him to blame a particular website for infesting his system. In a comment on his post, I proposed, based on my experience, that simply running as a non-administrator user instead on his clean unpatched Windows XP SP2 installation should have protected him for the most part.</p>
<p>I'm not suggesting that patching is a low priority but from my (potentially outdated) understanding of malware attack vectors, running as a least privileged user would have gone a long way. I tried to find some good websites to verify my assumptions but didn't have much luck. What follows is my interpretation of the situation, please leave a comment if I have underestimated the capabilities of today's malware.</p>
<ul>
<li><strong><a href="http://www.flickr.com/photos/xfer/27216541/" target="_blank"><img style="border-right:0;border-top:0;border-left:0;border-bottom:0;margin-left:2em;margin-bottom:2em;" alt="Ethernet connector virus figure" title="Photo by Marcelo Alves" src="http://www.codeassassin.com/blog/content/binary/WindowsLiveWriter/MalwareAndLeastPrivilege_1455E/rj45legs_1.jpg" align="right" border="0"></a> Most malware wants to get installed on your PC&nbsp;and&nbsp;survive a reboot:</strong> A non-admin user only has privileges to write to "safe" areas of your file system and registry. Malware would be unable to replace commonly used system files.&nbsp;It&nbsp;would be unable to install itself as a driver or service with higher privilege. It would be unable to schedule itself to run when another user logs on. It would be unable to place shortcuts in an area that another user would see in their profile. Lease privilege users cannot install browser plugins. System level root-kits should be unable to hook in and a reboot with a <a href="http://en.wikipedia.org/wiki/LiveDistro" target="_blank">Live CD</a> should be able to see and remove anything evil.
<li><strong>Most malware wants to provide remote access to your PC:</strong> XP SP2 ships with the firewall enabled. Malware would be able to <a href="http://en.wikipedia.org/wiki/Phoning_home" target="_blank">phone home</a> but would be unable to open a port and await incoming connections. Modern broadband routers naturally prevent incoming connections too. The malware would still only be able to give the remote user least privilege access to the system.
<li><strong>Most malware wants you to give it something: </strong>As a non-admin malware would not be able to modify your drivers/etc/hosts file to redirect network traffic. It would be able to spawn many popup windows attempting to sell you something but this would be nothing more than annoying. It could scan your user documents for email addresses but hopefully your contact list is online (eg Gmail) or in Outlook (which warns the user when accessed programmatically). It could log key presses and&nbsp;grab sensitive passwords, which is definitely a concern, but&nbsp;this may be reduced by the "remember my password" features in software.</li></ul>
<p>Jeff's situation was an extreme example of an unprotected system. Personally, I'm using Vista 64-bit which immediately reduces the amount of malware that is actually compatible. I'm also running non-admin with UAC on so anything questionable needs my permission. I have Internet Explorer 7 which displays the Information Bar whenever something wants special permission. Data Execution Prevention and ASLR are on by default to minimise exploitation of buggy system code. I still have Windows Defender and run Ad-Aware occasionally. Every installed application is patched to the latest update. Lastly, I avoid questionable material and have another separate non-admin user account if I really need to try something.</p>
<p>I'm sure I'm not 100% safe, but I don't think that's currently attainable. Any machines I remove malware from for friends get returned with a non-admin account and they only come back to me with more problems after sheepishly admitting they went back to an admin account. I have read that the new hardware-virtualization features in new CPUs (which I have enabled) could allow malicious code, and then there is everything else&nbsp;I haven't heard of.</p>
<p>I think I've rambled enough and probably missed many things but I'm interested in reading your thoughts on the matter. If you can recommend a good source for the latest PC security information I'd appreciate that too.</p>]]&gt;