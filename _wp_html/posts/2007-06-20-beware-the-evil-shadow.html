&lt;![CDATA[<p><a href="http://www.flickr.com/photos/herby_fr/51491971/" target="_blank"><img title="Photo by 'Herbert'" style="border-right:0;border-top:0;border-left:0;margin-right:2em;border-bottom:0;" alt="Evil Shadow" src="http://www.codeassassin.com/blog/content/binary/WindowsLiveWriter/BewareTheEvilShadow_13887/evilshadow_1.jpg" align="left" border="0"></a> Object-oriented programming principles have been an excellent addition to software development but one component that inevitably appears in OO languages has confounded me by it's uselessness. In VB.NET it is known as the "Shadows" modifier, in C# it is found in class member declarations sharing the name "new".</p>
<p>The purpose of this modifier keyword is to allow a subclass to redefine a property, field, or method of the base class where the base class has not been declared "Overridable" or "virtual" in VB.NET or C# respectively. Unfortunately it suffers from a major drawback, as demonstrated by the following code:</p>
<p><span style="font-size:11px;color:black;font-family:Courier New;background-color:transparent;"><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">class</span> Base<br />{<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">&nbsp;&nbsp;&nbsp;virtual</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">public</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">string</span> Extendable() { <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">return</span> <span style="font-size:11px;color:#666666;font-family:Courier New;background-color:#e4e4e4;">"Extend"</span>; }<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">&nbsp;&nbsp;&nbsp;public</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">string</span> Locked() { <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">return</span> <span style="font-size:11px;color:#666666;font-family:Courier New;background-color:#e4e4e4;">"Lock"</span>; }<br />}<br /><br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">class</span> Foo : Base<br />{<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">&nbsp;&nbsp;&nbsp;override</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">public</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">string</span> Extendable() { <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">return</span> <span style="font-size:11px;color:#666666;font-family:Courier New;background-color:#e4e4e4;">"Food"</span>; }<br /><span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">&nbsp;&nbsp;&nbsp;new</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">public</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">string</span> Locked() { <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">return</span> <span style="font-size:11px;color:#666666;font-family:Courier New;background-color:#e4e4e4;">"Picked"</span>; }<br />}<br /><br />Base b <span style="font-size:11px;color:red;font-family:Courier New;background-color:transparent;">=</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">new</span> Base();<br />b.Extendable(); <span style="font-size:11px;color:green;font-family:Courier New;background-color:transparent;">// returns "Extend"</span><br />b.Locked(); <span style="font-size:11px;color:green;font-family:Courier New;background-color:transparent;">// returns "Lock"</span><br /></span></p>
<p><span style="font-size:11px;color:black;font-family:Courier New;background-color:transparent;">Foo f <span style="font-size:11px;color:red;font-family:Courier New;background-color:transparent;">=</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">new</span> Foo();<br />f.Extendable(); <span style="font-size:11px;color:green;font-family:Courier New;background-color:transparent;">// returns "Food"</span><br />f.Locked(); <span style="font-size:11px;color:green;font-family:Courier New;background-color:transparent;">// returns "Picked"</span><br /></span></p>
<p><span style="font-size:11px;color:black;font-family:Courier New;background-color:transparent;">Base bf <span style="font-size:11px;color:red;font-family:Courier New;background-color:transparent;">=</span> <span style="font-size:11px;color:blue;font-family:Courier New;background-color:transparent;">new</span> Foo();<br />bf.Extendable(); <span style="font-size:11px;color:green;font-family:Courier New;background-color:transparent;">// returns "Food"</span><br />bf.Locked(); <span style="font-size:11px;color:green;font-family:Courier New;background-color:transparent;">// returns "Lock" !!!</span><br /></p></span>
<p>As you can see, if the Foo methods are called via a Foo-typed variable, there is no difference between shadowing and overriding. However, as soon as you call a Foo method via a Base-typed variable, or pass a Foo instance to another class expecting a Base, you lose the functionality of Foo.</p>
<p>If "new"&nbsp;is omitted from Foo's implementation of Locked, Visual Studio reports&nbsp;an error: <em>The keyword 'new' is required on 'Locked' because it hides method 'Base.Locked()'</em>. It is very easy for someone to simply add the keyword as required with realising the consequences.</p>
<p>Occasionally, all you might want to do is utilise some existing behaviour in a base class and add some more features and shadowing or member hiding is fine. The fact that you have used shadowing is not obvious in the calling code though. </p>
<p>Most of the time, I want to alter the behaviour of a base class and pass my new subclass to existing code, perhaps in the Framework, that is only expecting the base type. Beware.</p>]]&gt;